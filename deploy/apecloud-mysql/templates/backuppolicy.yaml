apiVersion: dataprotection.kubeblocks.io/v1alpha1
kind: BackupPolicy
metadata:
  name: apecloud-mysql-backup-policy
  labels:
    clusterdefinition.kubeblocks.io/name: apecloud-mysql
  annotations:
    dataprotection.kubeblocks.io/is-default-policy-template: "true"
spec:
  pathPrefix: /mydata/
  backoffLimit: 0
  target:
    podSelector:
      matchLabels:
        app.kubernetes.io/component: mysql
        app.kubernetes.io/instance: azolla35
        app.kubernetes.io/managed-by: kubeblocks
    connectionCredential:
      secretName: azolla35-conn-credential
      usernameKey: username
      passwordKey: password
      portKey: port
      hostKey: host
      endpointKey: endpoint
    serviceAccountName: kb-azolla35
  backupMethods:
  - name: xtrabackup
    snapshotVolumes: false
    actionSetName: xtrabackup-for-apecloud-mysql
    targetVolumes:
      volumeMounts:
      - name: data
        mountPath: /data/mysql
  - name: volume-snapshot
    snapshotVolumes: true
    targetVolumes:
      volumes:
      - data