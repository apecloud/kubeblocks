apiVersion: apps.kubeblocks.io/v1alpha1
kind: ComponentClassDefinition
metadata:
  name: kb.classes.default.apecloud-mysql.mysql
  labels:
    class.kubeblocks.io/provider: kubeblocks
    apps.kubeblocks.io/component-def-ref: mysql
    clusterdefinition.kubeblocks.io/name: apecloud-mysql
spec:
  groups:
  - resourceConstraintRef: kb-resource-constraint-general
    template: |
      cpu: {{ printf "{{ .cpu }}" }}
      memory: {{ printf "{{ .memory }}Gi" }}
      volumes:
      - name: data
        size: {{ printf "{{ .dataStorageSize }}Gi" }}
    vars: [ cpu, memory, dataStorageSize ]
    series:
    - namingTemplate: {{ printf "general-{{ .cpu }}c{{ .memory }}g" }}
      classes:
      - args: [ "0.5", "0.5", "20" ]
      - args: [ "1", "1", "20" ]
      - args: [ "2", "2", "20" ]
      - args: [ "2", "4", "20" ]
      - args: [ "2", "8", "20" ]
      - args: [ "4", "16", "20" ]
      - args: [ "8", "32", "20" ]
      - args: [ "16", "64", "20" ]
      - args: [ "32", "128", "20" ]
      - args: [ "64", "256", "20" ]
      - args: [ "128", "512", "20" ]

  - resourceConstraintRef: kb-resource-constraint-memory-optimized
    template: |
      cpu: {{ printf "{{ .cpu }}" }}
      memory: {{ printf "{{ .memory }}Gi" }}
      volumes:
      - name: data
        size: {{ printf "{{ .dataStorageSize }}Gi" }}
    vars: [ cpu, memory, dataStorageSize ]
    series:
    - namingTemplate: {{ printf "mo-{{ .cpu }}c{{ .memory }}g" }}
      classes:
      # 1:8
      - args: [ "2", "16", "20" ]
      - args: [ "4", "32", "20" ]
      - args: [ "8", "64", "20" ]
      - args: [ "12", "96", "20" ]
      - args: [ "24", "192", "20" ]
      - args: [ "48", "384", "20" ]
      # 1:16
      - args: [ "2", "32", "20" ]
      - args: [ "4", "64", "20" ]
      - args: [ "8", "128", "20" ]
      - args: [ "16", "256", "20" ]
      - args: [ "32", "512", "20" ]
      - args: [ "48", "768", "20" ]
      - args: [ "64", "1024", "20" ]
