# Default values for wesqlapp.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

image:
  registry: 
  repository: docker.io/infracreate/wesql-server-8.0
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: 0.1-SNAPSHOT

## MySQL Cluster parameters
cluster:
  ## CLUSTER_ID
  clusterId: "1"
  ## CLUSTER_START_INDEX
  clusterStartIndex: "1"
  ## @param cluster.replicaSetCount
  replicaSetCount: 3
  ## MYSQL_TEMPLATE_CONFIG
  templateConfig:
  ## MYSQL_CUSTOM_CONFIG
  customConfig:
  ## MYSQL_DYNAMIC_CONFIG
  dynamicConfig:

## MySQL Authentication parameters
auth:
  ## MYSQL_ROOT_HOST
  rootHost: "%"
  ## MYSQL_ROOT_USER
  rootUser: "root"
  ## @param auth.rootPassword Password for the `root` user. Ignored if existing secret is provided
  ##  MYSQL_ROOT_PASSWORD if null then MYSQL_ALLOW_EMPTY_PASSWORD=true
  rootPassword: ""
  ## @param auth.createDatabase Wheter to create the .Values.auth.database or not
  ##
  createDatabase: true
  ## @param auth.database Name for a custom database to create
  ## MYSQL_DATABASE
  database: "mydb"
  ## @param auth.username Name for a custom user to create
  ## MYSQL_USER
  username: "u1"
  ## MYSQL_PASSWORD
  password: "u1"
  ## @param auth.replicationUser MySQL replication user
  ##
  replicationUser: "replicator"
  ## @param auth.replicationPassword MySQL replication user password. Ignored if existing secret is provided
  ##
  replicationPassword: ""


configTemplate:
  ## @param config template name
  ## name: mysql-3node-tpl-8.0

  ## @param config template context
  configuration: |-
    [mysqld]
    # aliyun buffer pool: https://help.aliyun.com/document_detail/162326.html?utm_content=g_1000230851&spm=5176.20966629.toubu.3.f2991ddcpxxvD1#title-rey-j7j-4dt
    
    {{- if .Component.Resource -}}
    innodb-buffer-pool-size={{ mysql_buffer_size_cal .Component.Resource false }}
    {{ else -}}
    innodb-buffer-pool-size=128M
    {{- end -}}

    log-bin=master-bin
    gtid_mode=OFF
    consensus_auto_leader_transfer=ON
    
    log-error=/data/mysql/log/mysqld.err
    character-sets-dir=/usr/share/mysql-8.0/charsets
    datadir=/data/mysql/data
    port=3306
    general_log=1
    general_log_file=/data/mysql/mysqld.log
    pid-file=/data/mysql/run/mysqld.pid
    slow_query_log=1
    slow_query_log_file=/data/mysql/mysqld-slow.log
    socket=/data/mysql/tmp/mysqld.sock
    tmpdir=/data/mysql/tmp/
    loose-sha256_password_auto_generate_rsa_keys=0
    loose-caching_sha2_password_auto_generate_rsa_keys=0
    secure-file-priv=/data/mysql
    
    [client]
    port=3306
    socket=/data/mysql/tmp/mysqld.sock
    host=localhost

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""
appVersionOverride: ""
