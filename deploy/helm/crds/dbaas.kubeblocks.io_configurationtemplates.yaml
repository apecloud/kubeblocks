---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.9.0
  creationTimestamp: null
  name: configurationtemplates.dbaas.kubeblocks.io
spec:
  group: dbaas.kubeblocks.io
  names:
    categories:
    - dbaas
    kind: ConfigurationTemplate
    listKind: ConfigurationTemplateList
    plural: configurationtemplates
    shortNames:
    - ctpl
    singular: configurationtemplate
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - description: status phase
      jsonPath: .status.phase
      name: PHASE
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: AGE
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ConfigurationTemplate is the Schema for the configurationtemplates
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: ConfigurationTemplateSpec defines the desired state of ConfigurationTemplate
            properties:
              cfgSchemaTopLevelName:
                description: CfgSchemaTopLevelName is cue type name, which generate
                  openapi schema.
                type: string
              configurationSchema:
                description: ConfigurationSchema that impose restrictions on engine
                  parameter's rule.
                properties:
                  cue:
                    description: Cue that to let ISV verify user configuration through
                      cue language.
                    type: string
                  schema:
                    description: 'TODO(zt) DAY2 support schema Schema provides a way
                      for ISVs to validate the changed parameters through json. fix
                      controller-gen doesn''t work with k8s.io/apiextensions-apiserver:
                      https://github.com/kubernetes-sigs/controller-tools/issues/291'
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                type: object
              dynamicParameters:
                description: DynamicParameters field and StaticParameters field are
                  the same. for the convenience of the ISVs, if there are more static
                  parameters, it is recommended to use StaticParameters field, otherwise
                  it is recommended to use DynamicParameters field.
                items:
                  type: string
                type: array
              formatter:
                default: yaml
                description: Formatter describe the format of the configuration file,
                  the controller parses configuration file based on formatter, and
                  analyzes the modified parameters list, and then decides what policy
                  to use to make those modified parameters take effect.
                enum:
                - dotenv
                - ini
                - yaml
                - json
                - hcl
                type: string
              immutable:
                description: The configuration template is common, if it is modified
                  incorrectly, it will affect all clusters using this configuration,
                  we do not recommend modifying the template that is already online,
                  but modifications are inevitable during development or CICD, so
                  this control parameter is provided. if set to true, Configmap object
                  referenced by TplRef will also be modified to immutable. defaulted
                  to true.
                type: boolean
              immutableParameters:
                description: ImmutableParameters describe parameters that prohibit
                  user from modification.
                items:
                  type: string
                type: array
              staticParameters:
                description: After any parameters in StaticParameters are modified,
                  the controller need to restart the engine instance.
                items:
                  type: string
                type: array
              tplRef:
                description: TplRef is a reference to the configmap object, the configmap
                  determines how to generate the configurations.
                type: string
              upgradeMode:
                default: dynamic
                description: UpgradeMode describe parameter update mode. For ISVs,
                  it's impossible to enumerate all parameters, and when the user modify
                  unknown parameters, or ISVs does not configure StaticParameters
                  or DynamicParameters field, these parameters should be treated as
                  dynamic parameter or static parameter? if it is treated as static
                  parameter, the engine instance will be restarted, otherwise it will
                  be reloaded.
                enum:
                - dynamic
                - static
                type: string
            type: object
          status:
            description: ConfigurationTemplateStatus defines the observed state of
              ConfigurationTemplate.
            properties:
              message:
                description: If the configuration template is incorrect, Message field
                  describes the error information.
                type: string
              observedGeneration:
                description: observedGeneration is the most recent generation observed
                  for this ClusterDefinition. It corresponds to the ClusterDefinition's
                  generation, which is updated on mutation by the API Server.
                format: int64
                type: integer
              phase:
                description: Phase is configuration template status, if it is set
                  to AvailablePhase, ConfigurationTemplate be used by ClusterDefinition
                  or AppVersion.
                enum:
                - Available
                - Unavailable
                - Deleting
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
