# KubeBlocks 0.6.0 (2023-08-18)

We are happy to announce the official release of KubeBlocks 0.6.0! ðŸš€ ðŸŽ‰ ðŸŽˆ

This version supports stream computing engines Kafka and Pulsar and supports MySQL read-write splitting, introduces an interactive parameter configuration method.

We would like to extend our appreciation to all contributors who helped make this release happen.

## Highlights



## Acknowledgements

Thanks to everyone who made this release possible!

## What's New

### Pulsar

### Kafka

### MySQL

### PostgreSQL

### MongoDB

### Data migration

### Usability

### Backup and Restore

### Observability

### Bug Fixes

- There is a quota problem, no default resource limits are set for containers such as metrics. ([#2738](https://github.com/apecloud/kubeblocks/pull/2738), @nashtsai)
- cli ops command output lost ops name ([#2904](https://github.com/apecloud/kubeblocks/pull/2904), @ldming)
- probe event lost ([#3172](https://github.com/apecloud/kubeblocks/pull/3172), @xuriwuyun)
- update probe internal module ([#3414](https://github.com/apecloud/kubeblocks/pull/3414), @xuriwuyun)
- cli playground init cluster without sa, role and rolebinding ([#3428](https://github.com/apecloud/kubeblocks/pull/3428), @ldming)
- cli created cluster with wrong sa name ([#3500](https://github.com/apecloud/kubeblocks/pull/3500), @ldming)
- The cluster status and pod status are inconsistent. clusters can terminate faster than pods. ([#3558](https://github.com/apecloud/kubeblocks/pull/3558), @lynnleelhl)
- enable consensus_set controller by feature gate ([#3616](https://github.com/apecloud/kubeblocks/pull/3616), @free6om)
- licensing description ([#3664](https://github.com/apecloud/kubeblocks/pull/3664), @free6om)
- change preflight checks rule for low spec machine in test case ([#3722](https://github.com/apecloud/kubeblocks/pull/3722), @yangmeilly)
- redis prohibits passwordless access by default ([#3726](https://github.com/apecloud/kubeblocks/pull/3726),@Y-Rookie)
- mongodb post start script ([#3956](https://github.com/apecloud/kubeblocks/pull/3956), @xuriwuyun)
- mongodb pod terminating takes too long time ([#3971](https://github.com/apecloud/kubeblocks/pull/3971), @xuriwuyun)
- mongodb restore problem, reset password ([#3987](https://github.com/apecloud/kubeblocks/pull/3987), @xuriwuyun)
- MongoDB does not receive signals when terminating pods. ([#3990](https://github.com/apecloud/kubeblocks/pull/3990), @xuriwuyun)
- add more judgements for mongodb replset initialization ([#4034](https://github.com/apecloud/kubeblocks/pull/4034), @xuriwuyun)
- parallel_transformer concurrent map writes ([#4079](https://github.com/apecloud/kubeblocks/pull/4079), @free6om)
- probe mysql binding test fail ([#4082](https://github.com/apecloud/kubeblocks/pull/4082), @xuriwuyun)
- kbcli set componentserviceaccontName ([#4276](https://github.com/apecloud/kubeblocks/pull/4276), @xuriwuyun)
- create a default sa if probes is required and serviceaccountname not set ([#4280](https://github.com/apecloud/kubeblocks/pull/4280), @xuriwuyun)
- The processing logic of WeSQL scaling is not stable enough, and downsizing can easily lead to inconsistent kernel and cluster states. ([#4372](https://github.com/apecloud/kubeblocks/pull/4372), [#4293](https://github.com/apecloud/kubeblocks/pull/4293), [#3202](https://github.com/apecloud/kubeblocks/pull/3202), @leon-inf)
- replicationSet cluster phase is abnormal during h/v-scale operations. ([#4377](https://github.com/apecloud/kubeblocks/pull/4377), @Y-Rookie)
- PVCs are occasionally not deleted after scale-in. ([#4378](https://github.com/apecloud/kubeblocks/pull/4378), @lynnleelhl)
- kbcli cluster connect show example error 4403 ([#4404](https://github.com/apecloud/kubeblocks/pull/4404), @fengluodb)
- if cluster backup field is nil, do nothing ([#4435](https://github.com/apecloud/kubeblocks/pull/4435), @ldming)
- failed to enable kafka addon ([#4474](https://github.com/apecloud/kubeblocks/pull/4474), @ldming)
- unstable data protection test case ([#4497](https://github.com/apecloud/kubeblocks/pull/4497), @ldming)
- shutdown redis-server when create replication relationship failed and update postgresql start scripts ([#4568](https://github.com/apecloud/kubeblocks/pull/4568), @Y-Rookie)
- sa creation problem for template ([#4626](https://github.com/apecloud/kubeblocks/pull/4626), @xuriwuyun)
- mongodb restore problem ([#4690](https://github.com/apecloud/kubeblocks/pull/4690), @xuriwuyun)

## API changes

- New APIs:
    - backuprepos.dataprotection.kubeblocks.io
    - replicatedstatemachines.workloads.kubeblocks.io
    - storageproviders.storage.kubeblocks.io
- New API attributes:
    - clusters.apps.kubeblocks.io API
        - spec.availabilityPolicy
        - spec.backup
        - spec.tenancy
        - spec.replicas
        - spec.resources
        - spec.storage
        - spec.mode
        - spec.parameters
        - spec.monitor
        - spec.network
        - spec.componentSpecs.noCreatePDB
    - clusterdefinitions.apps.kubeblocks.io API
        - spec.componentDefs.componentDefRef
        - spec.componentDefs.configSpecs.asEnvfrom
        - spec.componentDefs.configSpecs.lazyRenderedConfigSpec
        - spec.componentDefs.statelessSpec
        - spec.componentDefs.statefulSpec
        - spec.componentDefs.switchoverSpec
        - spec.componentDefs.volumeProtectionSpec
        - spec.componentDefs.systemAccounts.accounts.provisionPolicy.statements.update
        - spec.componentDefs.consensusSpec.LLPodManagementPolicy
        - spec.componentDefs.consensusSpec.LLUpdateStrategy
    - clusterversions.apps.kubeblocks.io API
        - spec.componentVersions.configSpecs.asEnvFrom
        - spec.componentVersions.configSpecs.lazyRenderedConfigSpec
        - spec.componentVersions.systemAccountSpec
        - spec.componentVersions.switchoverSpec
    - configconstraint.apps.kubeblocks.io API
        - spec.toolsImageSpec
        - spec.scriptConfigs
        - spec.downwardAPIOptions
    - opsrequests.apps.kubeblocks.io API
        - spec.cancel
        - spec.switchover
        - spec.ttlSecondsBeforeAbort
        - spec.scriptSpec
        - status.components.reason
        - status.components.message
        - spec.verticalScaling.classDefRef
        - status.lastConfiguration.components.classDefRef
    - backuppolicytemplates.apps.kubeblocks.io API
        - spec.backupPolicies.schedule.StartingDeadlineMinutes
        - spec.backupPolicies.[snapshot|datafile|logfile].backupStatusUpdates.useTargetPodServiceAccount
    - backups.dataprotection.kubeblocks.io API
        - status.sourceCluster
        - status.availableReplicas
        - status.manifests.backupTool.VolumeName
    - backuppolicies.dataprotection.kubeblocks.io API
        - spec.[logfile|datafile].backupRepoName
        - spec.schedule.StartingDeadlineMinutes
        - spec.[snapshot|datafile|logfile].backupStatusUpdates.useTargetPodServiceAccount
    - backuptools.dataprotection.kubeblocks.io API
        - spec.logical.podScope
    - addons.extensions.kubeblocks.io API
        - spec.cliPlugins
        - spec.helm.chartsImage
        - spec.helm.chartsPathInImage
- Modified API attributes:
    - clusters.apps.kubeblocks.io API
        - spec.clusterDefinitionRef add validation MaxLength=63
        - spec.clusterVersionRef add validation MaxLength=63
        - spec.componentSpecs.name update validation MaxLength: `15` -> `22`
        - spec.componentSpecs.name update validation Pattern: `^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$` -> `^[a-z]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentSpecs.componentDefRef update validation MaxLength: `63` -> `22`
        - spec.componentSpecs.componentDefRef update validation Pattern: `^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$` -> `^[a-z]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentSpecs.classDefRef.name add validation MaxLength=63
        - spec.componentSpecs.classDefRef.name add validation Pattern=`^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$`
        - spec.componentSpecs.switchPolicy default value: `MaximumAvailability -> Noop`,  enum values`{MaximumAvailability, MaximumDataProtection, Noop} -> {Noop}`
    - clusterdefinitions.apps.kubeblocks.io API
        - spec.componentDefs.name update validation MaxLength: `18` -> `22`
        - spec.componentDefs.name update validation Pattern:  `^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$` -> `^[a-z]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentDefs.scriptSpecs.namespace add validation Pattern=`^[a-z0-9]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentDefs.scriptSpecs.volumeName update validation MaxLength:  `32` -> `63`
        - spec.componentDefs.scriptSpecs.volumeName add validation Pattern=`^[a-z]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentDefs.replicationSpec update type:  `ReplicationSpec` -> `ReplicationSetSpec`
        - spec.componentDefs.horizontalScalePolicy.type: delete Snapshot type and add CloneVolume type
    - clusterversions.apps.kubeblocks.io API
        - spec.componentVersions.configSpecs.namespace  add validation Pattern=`^[a-z0-9]([a-z0-9\-]*[a-z0-9])?$`
        - spec.componentVersions.configSpecs.volumeName update validation MaxLength:  `32` -> `63`
        - spec.componentVersions.configSpecs.volumeName add validation Pattern=`^[a-z]([a-z0-9\-]*[a-z0-9])?$`
    - componentclassdefinition.apps.kubeblocks.io API
        - status.classes update type `ComponentClassInstance` -> `ComponentClass`
    - componentresourceconstraint.apps.kubeblocks.io API
        - spec
    - configconstraint.apps.kubeblocks.io API
        - spec.reloadOptions.unixSignalTrigger.processName delete validation Pattern=`^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$`
        - spec.reloadOptions.shellTrigger
        - spec.reloadOptions.tplScriptTrigger.namespace add validation Pattern=`^[a-z0-9]([a-z0-9\-]*[a-z0-9])?$`
        - spec.formatterConfig.format add type props-plus
    - opsrequests.apps.kubeblocks.io API
        - spec.clusterRef add validation XValidation:rule="self == oldSelf"
        - spec.type add type Switchover and DataScript
        - spec.type add validation XValidation:rule="self == oldSelf"
        - spec.upgrade add validation XValidation:rule="self == oldSelf"
        - spec.horizontalScaling add validation XValidation:rule="self == oldSelf"
        - spec.restart add validation XValidation:rule="self == oldSelf"
        - spec.reconfigure add validation XValidation:rule="self == oldSelf"
        - spec.expose add validation XValidation:rule="self == oldSelf"
        - spec.restoreFrom add validation XValidation:rule="self == oldSelf"
        - status.phase add type Cancelling and Cancelled
    - backuppolicytemplates.apps.kubeblocks.io API
        - spec.backupPolicies.componentDefRef update validation MaxLength:  `63` -> `22`
        - spec.backupPolicies.componentDefRef  update validation Pattern: `^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$` -> `^[a-z]([a-z0-9\-]*[a-z0-9])?$`
        - spec.backupPolicies.[snapshot|datafile|logfile].backupStatusUpdates.updateStage update validation: optional -> required
    - backups.dataprotection.kubeblocks.io API
        - status.phase add type Running and Deleting
        - status.manifests.backupTool rename `checkSum` -> `checksum` and `CheckPoint` -> `checkpoint`
    - backuppolicies.dataprotection.kubeblocks.io API
        - spec.[logfile|datafile].persistentVolumeClaim update validation: `required` -> `optional`
        - spec.[logfile|datafile].persistentVolumeClaim.name update validation: `required` -> `optional`
        - spec.[logfile|datafile].persistentVolumeClaim.storageClassName add validation Pattern:`^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$`
        - spec.[logfile|datafile].persistentVolumeClaim.persistentVolumeConfigMap.name add validation Pattern: `^[a-z0-9]([a-z0-9\.\-]*[a-z0-9])?$`
        - spec.[logfile|datafile].persistentVolumeClaim.persistentVolumeConfigMap.namespace add validation Pattern: `^[a-z0-9]([a-z0-9\-]*[a-z0-9])?$`
    - backuptools.dataprotection.kubeblocks.io API
        - spec.deployKind update value `{job,daemon}` -> `{job, statefulSet}`
- Deleted API attributes:
    - clusters.apps.kubeblocks.io API
        - spec.componentSpecs.primaryIndex
    - clusterdefinitions.apps.kubeblocks.io API
        - spec.componentDefs.maxUnavailable
    - clusterversions.apps.kubeblocks.io API
        - spec.componentVersions.clientImage
    - componentclassdefinition.apps.kubeblocks.io API
        - spec.groups.resourceConstraintRef
    - opsrequests.apps.kubeblocks.io API
        - spec.verticalScaling.class
        - status.lastConfiguration.components.class
