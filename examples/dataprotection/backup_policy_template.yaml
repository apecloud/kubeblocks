# Standard Kubernetes Kind declaration. Required.
apiVersion: dataprotection.kubeblocks.io/v1alpha1
# Standard Kubernetes Kind declaration. Required.
kind: BackupPolicyTemplate
# Standard Kubernetes metadata. Required.
metadata:
  # Backup name. Maybe any valid Kubernetes object name. Required.
  name: backup-policy-template-wesql
# Parameters about the backup. Required.
spec:
  # schedule will be ignored when create a backup session in manual.
  # [optional]
  schedule: "0 18 * * *"
  # The amount of time before this backup is eligible for garbage collection. If not specified,
  # a default value of 30 days will be used. The default can be configured on the server
  # if set to infinity,
  # valid value: 30d      : 30 days:
  #              infinity :  backups will not be cleaned.
  ttl: 168h0m0s

  backupToolName: xtrabackup-mysql

  # database engine for cluster service
  databaseEngine: mysql

  hooks:
    preCommands:
      - touch /data/mysql/data/.restore; sync
    postCommands:
      - rm -f /data/mysql/data/.restore; sync

  # Number of backup retries on fail.
  onFailAttempted: 3
