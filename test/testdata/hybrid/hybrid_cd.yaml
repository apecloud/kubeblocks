apiVersion: apps.kubeblocks.io/v1alpha1
kind: ClusterDefinition
metadata:
  name: %s
spec:
  componentDefs:
  - antiAffinity: false
    workloadType: Stateless
    podSpec:
      containers:
      - name: busybox
    name: stateless
  - antiAffinity: false
    workloadType: Consensus
    name: consensus
    logConfigs:
    - filePathPattern: /data/mysql/log/mysqld.err
      name: error
    podSpec:
      containers:
      - name: mysql
    consensusSpec:
      followers:
      - accessMode: Readonly
        name: follower
      leader:
        accessMode: ReadWrite
        name: leader
      updateStrategy: BestEffortParallel
  - name: stateful
    pdbSpec:
      minAvailable: 1
    workloadType: Stateful
    podSpec:
      containers:
      - name: mysql
        ports:
        - containerPort: 3306
          name: mysql
          protocol: TCP